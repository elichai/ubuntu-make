310a311,320
> _ARCH_TRIPLET = {
>     'arm64': 'aarch64-linux-gnu',
>     'i386': 'i386-linux-gnu',
>     'ppc64el': 'powerpc64le-linux-gnu',
>     'powerpc': 'powerpc-linux-gnu',
>     'amd64': 'x86_64-linux-gnu',
>     's390x': 's390x-linux-gnu',
> }
>
>
348c358,379
<             self._handle = _dlopen(self._name, mode)
---
>            name = self._name
>            if name is not None and _os.getenv('SNAP_NAME', '') == 'ubuntu-make':
>                _name = _os.path.join(
>                    _os.getenv('SNAP'), 'lib',
>                    _ARCH_TRIPLET.get(_os.getenv('SNAP_ARCH')),
>                    name)
>                if not _os.path.exists(_name):
>                    _name = _os.path.join(
>                        _os.getenv('SNAP'), 'usr', 'lib',
>                        _ARCH_TRIPLET.get(_os.getenv('SNAP_ARCH')),
>                        name)
>                if not _os.path.exists(_name):
>                    _name = _os.path.join(
>                        _os.getenv('SNAP'), 'lib',
>                        name)
>                if not _os.path.exists(_name):
>                    _name = _os.path.join(
>                        _os.getenv('SNAP'), 'usr', 'lib',
>                        name)
>                if _os.path.exists(_name):
>                    name = _name
>            self._handle = _dlopen(name, mode)
351a383
>
422a455,474
>         if _os.getenv('SNAP_NAME', '') == 'ubuntu-make':
>             _name = _os.path.join(
>                 _os.getenv('SNAP'), 'lib',
>                 _ARCH_TRIPLET.get(_os.getenv('SNAP_ARCH')),
>                 name)
>             if not _os.path.exists(_name):
>                 _name = _os.path.join(
>                     _os.getenv('SNAP'), 'usr', 'lib',
>                     _ARCH_TRIPLET.get(_os.getenv('SNAP_ARCH')),
>                     name)
>             if not _os.path.exists(_name):
>                 _name = _os.path.join(
>                     _os.getenv('SNAP'), 'lib',
>                     name)
>             if not _os.path.exists(_name):
>                 _name = _os.path.join(
>                     _os.getenv('SNAP'), 'usr', 'lib',
>                     name)
>             if _os.path.exists(_name):
>                 name = _name
423a476
>
